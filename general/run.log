2023-10-31 14:23:43,863 [instantiator.py:21 in <module>] INFO - Created a temporary directory at /tmp/tmp676h0g_z
2023-10-31 14:23:43,864 [instantiator.py:76 in _write] INFO - Writing /tmp/tmp676h0g_z/_remote_module_non_scriptable.py
2023-10-31 14:23:44,388 [connectionpool.py:957 in _new_conn] DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2023-10-31 14:23:44,575 [connectionpool.py:428 in _make_request] DEBUG - https://huggingface.co:443 "HEAD /facebook/opt-125m/resolve/main/config.json HTTP/1.1" 200 0
2023-10-31 14:23:44,857 [connectionpool.py:428 in _make_request] DEBUG - https://huggingface.co:443 "HEAD /facebook/opt-125m/resolve/main/config.json HTTP/1.1" 200 0
2023-10-31 14:23:44,930 [model.py:132 in download] INFO - The whole model has been downloaded an processed to offload_folder: 'weights_offload_dir/facebook.opt-125m'
2023-10-31 14:23:44,930 [model.py:71 in __init__] INFO - weights offload folder: weights_offload_dir/facebook.opt-125m
2023-10-31 14:23:45,050 [connectionpool.py:428 in _make_request] DEBUG - https://huggingface.co:443 "HEAD /facebook/opt-125m/resolve/main/config.json HTTP/1.1" 200 0
2023-10-31 14:23:45,121 [model.py:81 in __init__] INFO - tied_params: [['lm_head.weight', 'model.decoder.embed_tokens.weight']]
2023-10-31 14:23:45,125 [model.py:263 in get_policy_weight_map] DEBUG - model.decoder.embed_tokens, [0. 0. 1.], size_todo: 86630400
2023-10-31 14:23:45,126 [model.py:263 in get_policy_weight_map] DEBUG - model.decoder.embed_positions, [0.         0.03918046 0.96081954], size_todo: 85056000
2023-10-31 14:23:45,126 [model.py:263 in get_policy_weight_map] DEBUG - model.decoder.final_layer_norm, [1.91116887e-05 3.91789619e-02 9.60801926e-01], size_todo: 85054464
2023-10-31 14:23:45,127 [model.py:263 in get_policy_weight_map] DEBUG - model.decoder.layers.0, [0.04997319 0.08332656 0.86670024], size_todo: 77966592
2023-10-31 14:23:45,128 [model.py:263 in get_policy_weight_map] DEBUG - model.decoder.layers.1, [0.07605041 0.1268119  0.79713769], size_todo: 70878720
2023-10-31 14:23:45,129 [model.py:263 in get_policy_weight_map] DEBUG - model.decoder.layers.2, [0.10571046 0.15066678 0.74362275], size_todo: 63790848
2023-10-31 14:23:45,130 [model.py:263 in get_policy_weight_map] DEBUG - model.decoder.layers.3, [0.12062976 0.17819364 0.7011766 ], size_todo: 56702976
2023-10-31 14:23:45,131 [model.py:263 in get_policy_weight_map] DEBUG - model.decoder.layers.4, [0.14055185 0.19276117 0.66668698], size_todo: 49615104
2023-10-31 14:23:45,132 [model.py:263 in get_policy_weight_map] DEBUG - model.decoder.layers.5, [0.1499285  0.21196308 0.63810841], size_todo: 42527232
2023-10-31 14:23:45,133 [model.py:263 in get_policy_weight_map] DEBUG - model.decoder.layers.6, [0.16439317 0.22156559 0.61404124], size_todo: 35439360
2023-10-31 14:23:45,134 [model.py:263 in get_policy_weight_map] DEBUG - model.decoder.layers.7, [0.17065379 0.23585085 0.59349535], size_todo: 28351488
2023-10-31 14:23:45,134 [model.py:263 in get_policy_weight_map] DEBUG - model.decoder.layers.8, [0.18173357 0.24251579 0.57575064], size_todo: 21263616
2023-10-31 14:23:45,135 [model.py:263 in get_policy_weight_map] DEBUG - model.decoder.layers.9, [0.18608848 0.27488348 0.53902803], size_todo: 14175744
2023-10-31 14:23:45,136 [model.py:263 in get_policy_weight_map] DEBUG - model.decoder.layers.10, [0.194913   0.27840721 0.5266798 ], size_todo: 7087872
2023-10-31 14:23:45,137 [model.py:263 in get_policy_weight_map] DEBUG - model.decoder.layers.11, [0.19802909 0.30507996 0.49689094], size_todo: 0
2023-10-31 14:23:45,138 [model.py:263 in get_policy_weight_map] DEBUG - lm_head, [0.19802909 0.30507996 0.49689094], size_todo: 0
2023-10-31 14:23:45,138 [model.py:269 in get_policy_weight_map] INFO - device_map is prepared!
2023-10-31 14:23:45,140 [model.py:305 in get_policy_weight_map] INFO - CausalLM facebook/opt-125m is to be loaded on: 
GPU Mem 0.05 GiB (19.80%), CPU Mem 0.07 GiB (30.51%), Disk Mem 0.12 Gib (49.69%)
2023-10-31 14:23:45,278 [connectionpool.py:428 in _make_request] DEBUG - https://huggingface.co:443 "HEAD /facebook/opt-125m/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2023-10-31 14:23:45,716 [model.py:395 in to_test_forward] DEBUG - model.decoder.embed_tokens to test forward
2023-10-31 14:23:45,717 [model.py:395 in to_test_forward] DEBUG - model.decoder.embed_positions to test forward
2023-10-31 14:23:45,717 [model.py:395 in to_test_forward] DEBUG - model.decoder.final_layer_norm to test forward
2023-10-31 14:23:45,717 [model.py:395 in to_test_forward] DEBUG - model.decoder.layers.0 to test forward
2023-10-31 14:23:45,717 [model.py:395 in to_test_forward] DEBUG - model.decoder.layers.1 to test forward
2023-10-31 14:23:45,717 [model.py:395 in to_test_forward] DEBUG - model.decoder.layers.2 to test forward
2023-10-31 14:23:45,718 [model.py:395 in to_test_forward] DEBUG - model.decoder.layers.3 to test forward
2023-10-31 14:23:45,718 [model.py:395 in to_test_forward] DEBUG - model.decoder.layers.4 to test forward
2023-10-31 14:23:45,718 [model.py:395 in to_test_forward] DEBUG - model.decoder.layers.5 to test forward
2023-10-31 14:23:45,718 [model.py:395 in to_test_forward] DEBUG - model.decoder.layers.6 to test forward
2023-10-31 14:23:45,718 [model.py:395 in to_test_forward] DEBUG - model.decoder.layers.7 to test forward
2023-10-31 14:23:45,718 [model.py:395 in to_test_forward] DEBUG - model.decoder.layers.8 to test forward
2023-10-31 14:23:45,718 [model.py:395 in to_test_forward] DEBUG - model.decoder.layers.9 to test forward
2023-10-31 14:23:45,718 [model.py:395 in to_test_forward] DEBUG - model.decoder.layers.10 to test forward
2023-10-31 14:23:45,719 [model.py:395 in to_test_forward] DEBUG - model.decoder.layers.11 to test forward
2023-10-31 14:23:45,719 [model.py:395 in to_test_forward] DEBUG - lm_head to test forward
2023-10-31 14:23:45,723 [model.py:350 in layer_cpu_load] DEBUG - load_layer_weights: model.decoder.embed_tokens to cpu
2023-10-31 14:23:45,725 [model.py:368 in layer_cpu_offload] DEBUG - offload_layer_weights: model.decoder.embed_tokens to meta


2023-10-31 14:23:45,726 [model.py:350 in layer_cpu_load] DEBUG - load_layer_weights: model.decoder.embed_positions to cpu
2023-10-31 14:23:45,727 [model.py:368 in layer_cpu_offload] DEBUG - offload_layer_weights: model.decoder.embed_positions to meta


2023-10-31 14:23:45,728 [model.py:350 in layer_cpu_load] DEBUG - load_layer_weights: model.decoder.layers.0 to cpu
2023-10-31 14:23:45,736 [model.py:368 in layer_cpu_offload] DEBUG - offload_layer_weights: model.decoder.layers.0 to meta


2023-10-31 14:23:45,739 [model.py:350 in layer_cpu_load] DEBUG - load_layer_weights: model.decoder.layers.1 to cpu
2023-10-31 14:23:45,745 [model.py:368 in layer_cpu_offload] DEBUG - offload_layer_weights: model.decoder.layers.1 to meta


2023-10-31 14:23:45,748 [model.py:350 in layer_cpu_load] DEBUG - load_layer_weights: model.decoder.layers.2 to cpu
2023-10-31 14:23:45,754 [model.py:368 in layer_cpu_offload] DEBUG - offload_layer_weights: model.decoder.layers.2 to meta


2023-10-31 14:23:45,757 [model.py:350 in layer_cpu_load] DEBUG - load_layer_weights: model.decoder.layers.3 to cpu
2023-10-31 14:23:45,763 [model.py:368 in layer_cpu_offload] DEBUG - offload_layer_weights: model.decoder.layers.3 to meta


2023-10-31 14:23:45,766 [model.py:350 in layer_cpu_load] DEBUG - load_layer_weights: model.decoder.layers.4 to cpu
2023-10-31 14:23:45,772 [model.py:368 in layer_cpu_offload] DEBUG - offload_layer_weights: model.decoder.layers.4 to meta


2023-10-31 14:23:45,775 [model.py:350 in layer_cpu_load] DEBUG - load_layer_weights: model.decoder.layers.5 to cpu
2023-10-31 14:23:45,782 [model.py:368 in layer_cpu_offload] DEBUG - offload_layer_weights: model.decoder.layers.5 to meta


2023-10-31 14:23:45,785 [model.py:350 in layer_cpu_load] DEBUG - load_layer_weights: model.decoder.layers.6 to cpu
2023-10-31 14:23:45,794 [model.py:368 in layer_cpu_offload] DEBUG - offload_layer_weights: model.decoder.layers.6 to meta


2023-10-31 14:23:45,797 [model.py:350 in layer_cpu_load] DEBUG - load_layer_weights: model.decoder.layers.7 to cpu
2023-10-31 14:23:45,804 [model.py:368 in layer_cpu_offload] DEBUG - offload_layer_weights: model.decoder.layers.7 to meta


2023-10-31 14:23:45,807 [model.py:350 in layer_cpu_load] DEBUG - load_layer_weights: model.decoder.layers.8 to cpu
2023-10-31 14:23:45,814 [model.py:368 in layer_cpu_offload] DEBUG - offload_layer_weights: model.decoder.layers.8 to meta


2023-10-31 14:23:45,817 [model.py:350 in layer_cpu_load] DEBUG - load_layer_weights: model.decoder.layers.9 to cpu
2023-10-31 14:23:45,824 [model.py:368 in layer_cpu_offload] DEBUG - offload_layer_weights: model.decoder.layers.9 to meta


2023-10-31 14:23:45,827 [model.py:350 in layer_cpu_load] DEBUG - load_layer_weights: model.decoder.layers.10 to cpu
2023-10-31 14:23:45,834 [model.py:368 in layer_cpu_offload] DEBUG - offload_layer_weights: model.decoder.layers.10 to meta


2023-10-31 14:23:45,837 [model.py:350 in layer_cpu_load] DEBUG - load_layer_weights: model.decoder.layers.11 to cpu
2023-10-31 14:23:45,844 [model.py:368 in layer_cpu_offload] DEBUG - offload_layer_weights: model.decoder.layers.11 to meta


2023-10-31 14:23:45,847 [model.py:350 in layer_cpu_load] DEBUG - load_layer_weights: model.decoder.final_layer_norm to cpu
2023-10-31 14:23:45,848 [model.py:368 in layer_cpu_offload] DEBUG - offload_layer_weights: model.decoder.final_layer_norm to meta


2023-10-31 14:23:45,849 [model.py:350 in layer_cpu_load] DEBUG - load_layer_weights: lm_head to cpu
2023-10-31 14:23:45,864 [model.py:368 in layer_cpu_offload] DEBUG - offload_layer_weights: lm_head to meta


2023-10-31 14:23:45,869 [model.py:403 in reset_forward] DEBUG - model.decoder.embed_tokens from test to old.
2023-10-31 14:23:45,870 [model.py:403 in reset_forward] DEBUG - model.decoder.embed_positions from test to old.
2023-10-31 14:23:45,870 [model.py:403 in reset_forward] DEBUG - model.decoder.final_layer_norm from test to old.
2023-10-31 14:23:45,870 [model.py:403 in reset_forward] DEBUG - model.decoder.layers.0 from test to old.
2023-10-31 14:23:45,870 [model.py:403 in reset_forward] DEBUG - model.decoder.layers.1 from test to old.
2023-10-31 14:23:45,870 [model.py:403 in reset_forward] DEBUG - model.decoder.layers.2 from test to old.
2023-10-31 14:23:45,870 [model.py:403 in reset_forward] DEBUG - model.decoder.layers.3 from test to old.
2023-10-31 14:23:45,870 [model.py:403 in reset_forward] DEBUG - model.decoder.layers.4 from test to old.
2023-10-31 14:23:45,870 [model.py:403 in reset_forward] DEBUG - model.decoder.layers.5 from test to old.
2023-10-31 14:23:45,871 [model.py:403 in reset_forward] DEBUG - model.decoder.layers.6 from test to old.
2023-10-31 14:23:45,871 [model.py:403 in reset_forward] DEBUG - model.decoder.layers.7 from test to old.
2023-10-31 14:23:45,871 [model.py:403 in reset_forward] DEBUG - model.decoder.layers.8 from test to old.
2023-10-31 14:23:45,871 [model.py:403 in reset_forward] DEBUG - model.decoder.layers.9 from test to old.
2023-10-31 14:23:45,871 [model.py:403 in reset_forward] DEBUG - model.decoder.layers.10 from test to old.
2023-10-31 14:23:45,872 [model.py:403 in reset_forward] DEBUG - model.decoder.layers.11 from test to old.
2023-10-31 14:23:45,872 [model.py:403 in reset_forward] DEBUG - lm_head from test to old.
2023-10-31 14:23:45,888 [model.py:518 in init_all_weights] DEBUG - init all weights...
2023-10-31 14:23:47,505 [flexgen.py:257 in layer_to_flexgen] DEBUG - model.decoder.embed_tokens to flexgen forward
2023-10-31 14:23:47,506 [flexgen.py:257 in layer_to_flexgen] DEBUG - model.decoder.embed_positions to flexgen forward
2023-10-31 14:23:47,506 [flexgen.py:257 in layer_to_flexgen] DEBUG - model.decoder.layers.0 to flexgen forward
2023-10-31 14:23:47,506 [flexgen.py:257 in layer_to_flexgen] DEBUG - model.decoder.layers.1 to flexgen forward
2023-10-31 14:23:47,506 [flexgen.py:257 in layer_to_flexgen] DEBUG - model.decoder.layers.2 to flexgen forward
2023-10-31 14:23:47,507 [flexgen.py:257 in layer_to_flexgen] DEBUG - model.decoder.layers.3 to flexgen forward
2023-10-31 14:23:47,507 [flexgen.py:257 in layer_to_flexgen] DEBUG - model.decoder.layers.4 to flexgen forward
2023-10-31 14:23:47,507 [flexgen.py:257 in layer_to_flexgen] DEBUG - model.decoder.layers.5 to flexgen forward
2023-10-31 14:23:47,507 [flexgen.py:257 in layer_to_flexgen] DEBUG - model.decoder.layers.6 to flexgen forward
2023-10-31 14:23:47,508 [flexgen.py:257 in layer_to_flexgen] DEBUG - model.decoder.layers.7 to flexgen forward
2023-10-31 14:23:47,508 [flexgen.py:257 in layer_to_flexgen] DEBUG - model.decoder.layers.8 to flexgen forward
2023-10-31 14:23:47,508 [flexgen.py:257 in layer_to_flexgen] DEBUG - model.decoder.layers.9 to flexgen forward
2023-10-31 14:23:47,509 [flexgen.py:257 in layer_to_flexgen] DEBUG - model.decoder.layers.10 to flexgen forward
2023-10-31 14:23:47,509 [flexgen.py:257 in layer_to_flexgen] DEBUG - model.decoder.layers.11 to flexgen forward
2023-10-31 14:23:47,509 [flexgen.py:257 in layer_to_flexgen] DEBUG - model.decoder.final_layer_norm to flexgen forward
2023-10-31 14:23:47,509 [flexgen.py:257 in layer_to_flexgen] DEBUG - lm_head to flexgen forward
2023-10-31 14:23:47,644 [connectionpool.py:428 in _make_request] DEBUG - https://huggingface.co:443 "HEAD /facebook/opt-125m/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
